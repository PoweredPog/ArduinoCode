#include <iostream>
#include <iomanip>
#include <sstream>
//removes the use of "std::" to increase readablity 
using namespace std;

//Sets the double parameter the amount of decimals determined by int parameter
//returns truncated string (Rounding not included in this function)
string string_precision(double x, int y){
    ostringstream stream;
    stream<<fixed<<setprecision(y)<<x;
    return stream.str();
}
//1 Way conversion into larger Order of Magnitudes(OOMs), only built for print
//functions does not change initial value 
string convert(double val){
    string suffix="w";
    if(val/1000000>1){
        val/=1000000;
        val=(int)(val*100+0.5);
        val/=100;
        suffix="mW";
    }else if(val/1000>1){
        val/=1000;
        val=(int)(val*100+.5);
        val/=100;
        suffix="kW";
    }
    return(string_precision(val,2)+suffix);
}

//Intakes a value as a double and formates it as a money value, rounded to two digits
string formComma(double val){
    string concat;
    string valString=string_precision(val,0);
    int tp=0;
    int count = valString.length();
    int cents = (val*100);
    cents = cents%100;
    string centsStr = "."+string_precision(cents,0);
    if(cents==0){
        centsStr="";
    }
    if(cents/10<1){
        centsStr=".0"+string_precision(cents,0);
    }
    int value = val;
    while(value>=1000){
        tp=value%1000;
        value/=1000;
        count-=3;
        concat+=","+valString.substr(count,3);
    }
    return (string_precision(value,0)+concat+centsStr);
}
//Calculates(calc) the average wattage in both daily and monthly and eventually
//will include saved price, only returns a print statment
string calc(double pvTot, double dayRange, double price){
    double pvAvg=pvTot/dayRange;
    double pvMonthAvg = pvTot/(dayRange/30);
    string value = 
    ("\n{\n\tTotal: " + convert(pvTot)
    + "\n\tDaily Average: " + convert(pvAvg)
    + "\n\tMonthly Average: " + convert(pvMonthAvg)
    + "\n\tMonthly Average bill $" + formComma(pvMonthAvg*price/1000)
    + "\n}");
    return value;  
}

int main(){
    double pvTot,dayRange,priceKwh; 
    cout<< "Please enter Total Energy, the amount of days, and the price per Kwh: \n";
    cin >> pvTot;
    cin >> dayRange;
    cin >> priceKwh;
    cout << calc(pvTot, dayRange, priceKwh);
}
